<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="View live cricket matches, upcoming fixtures, and join fantasy contests on Surabhi - India's FREE-TO-PLAY fantasy cricket platform.">
    <meta name="keywords" content="live cricket matches, fantasy cricket, upcoming matches, cricket scores, Surabhi">
    <meta name="author" content="SDSURABHI INFRA PRIVATE LIMITED">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Live Matches - Surabhi Fantasy Cricket">
    <meta property="og:description" content="View live cricket matches and join fantasy contests on Surabhi.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://skillarenasports.com/pages/matches.html">
    
    <title>Live Matches - Surabhi Fantasy Cricket</title>
    
    <link rel="icon" type="image/png" href="../assets/icons/favicon_v2.png">
    <link rel="stylesheet" href="../css/theme.css">
    
    <style>
        /* Matches Page Specific Styles */
        .matches-hero {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
            padding: 100px 0 60px;
            text-align: center;
        }
        
        .matches-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .matches-hero p {
            color: var(--text-secondary);
            font-size: 1.2rem;
        }
        
        /* Tabs */
        .match-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 2rem 0;
            background: var(--bg-secondary);
            position: sticky;
            top: 70px;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tab-btn {
            padding: 12px 30px;
            background: transparent;
            border: 2px solid var(--border-color);
            border-radius: 50px;
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab-btn:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }
        
        .tab-btn.active {
            background: var(--accent-green);
            border-color: var(--accent-green);
            color: var(--bg-primary);
        }
        
        .tab-btn .count {
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        
        .tab-btn.active .count {
            background: rgba(0,0,0,0.2);
        }
        
        /* Matches Container */
        .matches-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .matches-section {
            display: none;
        }
        
        .matches-section.active {
            display: block;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title .live-dot {
            width: 10px;
            height: 10px;
            background: #ff4444;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }
        
        /* Match Cards Grid */
        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 1.5rem;
        }
        
        /* Match Card */
        .match-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .match-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-green);
            box-shadow: 0 10px 40px rgba(0, 255, 136, 0.1);
        }
        
        .match-card-header {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, transparent 100%);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        .match-series {
            font-size: 0.85rem;
            color: var(--text-secondary);
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .match-type {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .match-type.t20 { background: #ff6b6b; color: white; }
        .match-type.odi { background: #4ecdc4; color: white; }
        .match-type.test { background: #a855f7; color: white; }
        
        .match-card-body {
            padding: 20px;
        }
        
        .teams-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            flex: 1;
        }
        
        .team-logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px solid var(--border-color);
        }
        
        .team-logo img {
            width: 45px;
            height: 45px;
            object-fit: contain;
        }
        
        .team-name {
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            max-width: 100px;
        }
        
        .team-score {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-green);
        }
        
        .vs-badge {
            background: var(--bg-primary);
            padding: 10px 15px;
            border-radius: 50%;
            font-weight: 700;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .match-info {
            text-align: center;
            padding: 15px 0;
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }
        
        .match-status {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .match-status.live {
            color: #ff4444;
            font-weight: 600;
        }
        
        .match-time {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .match-venue {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }
        
        .match-card-footer {
            display: flex;
            gap: 10px;
        }
        
        .btn-contest {
            flex: 1;
            padding: 12px;
            background: var(--accent-green);
            color: var(--bg-primary);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            text-decoration: none;
        }
        
        .btn-contest:hover {
            background: var(--accent-green-dark);
            transform: scale(1.02);
        }
        
        .btn-contest:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-scorecard {
            padding: 12px 20px;
            background: transparent;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-scorecard:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }
        
        /* Loading State */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            gap: 20px;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }
        
        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .empty-state p {
            color: var(--text-secondary);
        }
        
        /* Fantasy Badge */
        .fantasy-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--accent-green);
            border-radius: 20px;
            font-size: 0.75rem;
            color: var(--accent-green);
            margin-left: 10px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .matches-hero h1 {
                font-size: 2rem;
            }
            
            .match-tabs {
                flex-wrap: wrap;
                padding: 1rem;
                gap: 0.5rem;
            }
            
            .tab-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .matches-grid {
                grid-template-columns: 1fr;
            }
            
            .matches-container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-inner">
            <a href="../index.html" class="logo">
                <img src="../assets/images/logo_v2.webp" alt="Surabhi">
            </a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="matches.html" class="active">Matches</a></li>
                    <li><a href="how-to-play.html">How to Play</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            <div class="nav-buttons" id="navButtons">
                <a href="login.html" class="btn btn-ghost" id="loginBtn">Login</a>
                <a href="register.html" class="btn btn-primary" id="registerBtn">Get Started</a>
                <a href="dashboard.html" class="btn btn-primary" id="dashboardBtn" style="display: none;">Dashboard</a>
            </div>
            <button class="mobile-toggle" id="mobileToggle" aria-label="Menu">
                <span></span><span></span><span></span>
            </button>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="matches.html">Matches</a></li>
            <li><a href="how-to-play.html">How to Play</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
        <div class="mobile-menu-buttons" id="mobileNavButtons">
            <a href="login.html" class="btn btn-ghost">Login</a>
            <a href="register.html" class="btn btn-primary">Get Started</a>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="matches-hero">
        <div class="container">
            <h1>üèè Live Matches</h1>
            <p>Join fantasy contests for live and upcoming cricket matches</p>
        </div>
    </section>

    <!-- Match Tabs -->
    <div class="match-tabs">
        <button class="tab-btn active" data-tab="live">
            <span class="live-dot" style="width: 8px; height: 8px; background: #ff4444; border-radius: 50%; animation: pulse 1.5s infinite;"></span>
            Live <span class="count" id="liveCount">0</span>
        </button>
        <button class="tab-btn" data-tab="upcoming">
            üìÖ Upcoming <span class="count" id="upcomingCount">0</span>
        </button>
        <button class="tab-btn" data-tab="completed">
            ‚úÖ Completed <span class="count" id="completedCount">0</span>
        </button>
    </div>

    <!-- Matches Container -->
    <div class="matches-container">
        <!-- Live Matches -->
        <div class="matches-section active" id="liveSection">
            <h2 class="section-title">
                <span class="live-dot"></span>
                Live Matches
            </h2>
            <div class="matches-grid" id="liveMatches">
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">Loading live matches...</p>
                </div>
            </div>
        </div>

        <!-- Upcoming Matches -->
        <div class="matches-section" id="upcomingSection">
            <h2 class="section-title">üìÖ Upcoming Matches</h2>
            <div class="matches-grid" id="upcomingMatches">
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">Loading upcoming matches...</p>
                </div>
            </div>
        </div>

        <!-- Completed Matches -->
        <div class="matches-section" id="completedSection">
            <h2 class="section-title">‚úÖ Completed Matches</h2>
            <div class="matches-grid" id="completedMatches">
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">Loading completed matches...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="../index.html" class="footer-logo">
                        <img src="../assets/images/logo_v2.webp" alt="Surabhi">
                    </a>
                    <p>India's premier FREE-TO-PLAY fantasy cricket platform for entertainment and education.</p>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="matches.html">Matches</a></li>
                        <li><a href="how-to-play.html">How to Play</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                        <li><a href="matches.html">Matches</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="terms.html">Terms & Conditions</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="fair-play.html">Fair Play Policy</a></li>
                        <li><a href="responsible-gaming.html">Responsible Gaming</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Contact</h4>
                    <ul>
                        <li>Ram Acchayvar 48/2</li>
                        <li>Ayodhya Puri 2, Bijnour</li>
                        <li>Lucknow, UP 226008</li>
                        <li><a href="mailto:support@skillarenasports.com">support@skillarenasports.com</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-disclaimer">
                <div class="disclaimer-badges">
                    <span class="disclaimer-badge">üîû 18+ ONLY</span>
                    <span class="disclaimer-badge">üö´ NO REAL MONEY</span>
                    <span class="disclaimer-badge">üéÆ ENTERTAINMENT ONLY</span>
                    <span class="disclaimer-badge">üìç STATE RESTRICTIONS APPLY</span>
                </div>
                <p class="disclaimer-text">
                    FREE-TO-PLAY fantasy cricket platform operated by SDSURABHI INFRA PRIVATE LIMITED (CIN: U41002UP2023PTC194590), designed purely for entertainment and educational purposes. No real money is involved, and no prizes or winnings are awarded. Users must be 18 years or older. Users from Andhra Pradesh, Assam, Nagaland, Odisha, Sikkim, and Telangana are not permitted to participate due to government compliance requirements.
                </p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Surabhi. All rights reserved. Operated by SDSURABHI INFRA PRIVATE LIMITED (CIN: U41002UP2023PTC194590)</p>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top -->
    <button class="scroll-top" id="scrollTop" aria-label="Scroll to top">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
    </button>

    <!-- Cookie Banner -->
    <div class="cookie-banner" id="cookieBanner">
        <div class="cookie-content">
            <h4>üç™ We Use Cookies</h4>
            <p>We use cookies to improve your experience. <a href="privacy.html">Privacy Policy</a></p>
            <div class="cookie-buttons">
                <button class="btn btn-ghost" id="cookieDecline">Decline</button>
                <button class="btn btn-primary" id="cookieAccept">Accept</button>
            </div>
        </div>
    </div>

    <script src="../js/lib/chart.min.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/match-stats.js"></script>
    <script>
        // Tab functionality
        const tabBtns = document.querySelectorAll('.tab-btn');
        const sections = document.querySelectorAll('.matches-section');
        
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tab = btn.dataset.tab;
                
                tabBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                sections.forEach(s => s.classList.remove('active'));
                document.getElementById(`${tab}Section`).classList.add('active');
            });
        });
        
        // Fetch and display matches - handled by fetchAllMatches and fetchLiveMatches
        
        function displayMatches(containerId, matches, type) {
            const container = document.getElementById(containerId);
            
            if (matches.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M8 12h8M12 8v8"/>
                        </svg>
                        <h3>No ${type} matches</h3>
                        <p>Check back later for ${type} cricket matches.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = matches.map(match => createMatchCard(match, type)).join('');
        }
        
        function createMatchCard(match, type) {
            const team1 = match.teamInfo?.[0] || { name: match.teams?.[0] || 'Team 1', img: '' };
            const team2 = match.teamInfo?.[1] || { name: match.teams?.[1] || 'Team 2', img: '' };
            
            // Improved score matching - case insensitive and handles various formats
            function findScore(scores, teamName, teamShortname) {
                if (!scores || scores.length === 0) return null;
                const searchTerms = [teamName, teamShortname].filter(Boolean).map(t => t.toLowerCase());
                return scores.find(s => {
                    const inning = (s.inning || '').toLowerCase();
                    return searchTerms.some(term => inning.includes(term.toLowerCase()));
                });
            }
            
            // Get scores - try to match by index if name matching fails
            let scoreData1 = findScore(match.score, team1.name, team1.shortname);
            let scoreData2 = findScore(match.score, team2.name, team2.shortname);
            
            // Fallback: if we have exactly 2 scores and couldn't match, use index order
            if (match.score?.length >= 2 && (!scoreData1 || !scoreData2)) {
                scoreData1 = match.score[0];
                scoreData2 = match.score[1];
            } else if (match.score?.length === 1 && !scoreData1 && !scoreData2) {
                scoreData1 = match.score[0];
            }
            
            const score1Display = scoreData1 ? `${scoreData1.r}/${scoreData1.w} (${scoreData1.o})` : '-';
            const score2Display = scoreData2 ? `${scoreData2.r}/${scoreData2.w} (${scoreData2.o})` : '-';
            
            const isLive = type === 'live';
            const isCompleted = type === 'completed';
            const isUpcoming = type === 'upcoming';
            
            let statusClass = '';
            let statusText = match.status || match.dateTimeIST;
            
            if (isLive) {
                statusClass = 'live';
                statusText = 'üî¥ LIVE - ' + (match.status || 'In Progress');
            } else if (isCompleted) {
                statusText = match.status || 'Match Completed';
            }
            
            // Fantasy is available for all matches through our API
            
            return `
                <div class="match-card" data-match-id="${match.id}">
                    <div class="match-card-header">
                        <span class="match-series">${match.name || 'Cricket Match'}</span>
                        <span class="match-type ${match.matchType?.toLowerCase()}">${match.matchType || 'MATCH'}</span>
                    </div>
                    <div class="match-card-body">
                        <div class="teams-container">
                            <div class="team">
                                <div class="team-logo">
                                    <img src="${team1.img || '../assets/images/cricket-ball.png'}" alt="${team1.name}" onerror="this.src='../assets/images/cricket-ball.png'">
                                </div>
                                <span class="team-name">${team1.shortname || team1.name}</span>
                                ${!isUpcoming ? `<span class="team-score">${score1Display}</span>` : ''}
                            </div>
                            <div class="vs-badge">VS</div>
                            <div class="team">
                                <div class="team-logo">
                                    <img src="${team2.img || '../assets/images/cricket-ball.png'}" alt="${team2.name}" onerror="this.src='../assets/images/cricket-ball.png'">
                                </div>
                                <span class="team-name">${team2.shortname || team2.name}</span>
                                ${!isUpcoming ? `<span class="team-score">${score2Display}</span>` : ''}
                            </div>
                        </div>
                        <div class="match-info">
                            <p class="match-status ${statusClass}">${statusText}</p>
                            ${isUpcoming ? `<p class="match-time">üïê ${match.dateTimeIST}</p>` : ''}
                            <p class="match-venue">üìç ${match.venue || 'Venue TBA'}</p>
                        </div>
                        <div class="match-card-footer">
                            ${isUpcoming ? 
                                `<button class="btn-contest" onclick="handleCreateTeam('${match.id}')">Create Team</button>` :
                                isLive ?
                                `<button class="btn-contest" disabled>Contest Locked</button>` :
                                isCompleted ?
                                `<a href="scorecard.html?match=${match.id}" class="btn-contest">View Scorecard</a>` :
                                `<button class="btn-contest" disabled>Match Data Unavailable</button>`
                            }
                            ${!isUpcoming ? `<button class="btn-scorecard" onclick="openMatchStats('${match.id}')" title="View Statistics">üìä</button>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }
        
        function viewScorecard(matchId) {
            window.location.href = `scorecard.html?match=${matchId}`;
        }
        
        function showError() {
            const containers = ['liveMatches', 'upcomingMatches', 'completedMatches'];
            containers.forEach(id => {
                document.getElementById(id).innerHTML = `
                    <div class="empty-state">
                        <h3>Unable to load matches</h3>
                        <p>Please try again later.</p>
                    </div>
                `;
            });
        }
        
        // Track user login status
        let isLoggedIn = false;
        
        // Check auth status
        async function checkAuth() {
            try {
                const response = await fetch('/api/auth/me');
                const data = await response.json();
                
                if (data.user) {
                    isLoggedIn = true;
                    document.getElementById('loginBtn').style.display = 'none';
                    document.getElementById('registerBtn').style.display = 'none';
                    document.getElementById('dashboardBtn').style.display = 'inline-block';
                }
            } catch (error) {
                isLoggedIn = false;
            }
        }
        
        // Handle Create Team click - check if user is logged in
        function handleCreateTeam(matchId) {
            if (isLoggedIn) {
                window.location.href = `create-team.html?match=${matchId}`;
            } else {
                // Store the intended match for redirect after login
                sessionStorage.setItem('redirectAfterLogin', `create-team.html?match=${matchId}`);
                alert('Please login or register to create a team.');
                window.location.href = 'login.html';
            }
        }
        
        // Fetch only live matches (for 3-second refresh)
        async function fetchLiveMatches() {
            try {
                const response = await fetch('/api/cricket/current-matches');
                const data = await response.json();
                
                if (data.success) {
                    displayMatches('liveMatches', data.live, 'live');
                    document.getElementById('liveCount').textContent = data.live.length;
                    
                    // Also update completed if any match just finished
                    displayMatches('completedMatches', data.completed, 'completed');
                    document.getElementById('completedCount').textContent = data.completed.length;
                }
            } catch (error) {
                console.error('Error fetching live matches:', error);
            }
        }
        
        // Fetch all matches (for initial load and hourly refresh)
        async function fetchAllMatches() {
            try {
                const response = await fetch('/api/cricket/current-matches');
                const data = await response.json();
                
                if (data.success) {
                    displayMatches('liveMatches', data.live, 'live');
                    displayMatches('upcomingMatches', data.upcoming, 'upcoming');
                    displayMatches('completedMatches', data.completed, 'completed');
                    
                    // Update counts
                    document.getElementById('liveCount').textContent = data.live.length;
                    document.getElementById('upcomingCount').textContent = data.upcoming.length;
                    document.getElementById('completedCount').textContent = data.completed.length;
                }
            } catch (error) {
                console.error('Error fetching matches:', error);
                showError();
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Check auth first
            await checkAuth();
            
            // Initial fetch of all matches
            fetchAllMatches();
            
            // Refresh live matches every 3 seconds for real-time score updates
            setInterval(fetchLiveMatches, 3000);
            
            // Refresh upcoming matches every 1 hour
            setInterval(fetchAllMatches, 3600000);
        });
    </script>
</body>
</html>
