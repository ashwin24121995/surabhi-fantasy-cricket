<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="View detailed cricket match scorecard on Surabhi Fantasy Cricket">
    <meta name="keywords" content="cricket scorecard, match details, batting scorecard, bowling scorecard">
    <title>Match Scorecard - Surabhi Fantasy Cricket</title>
    <link rel="icon" type="image/png" href="../assets/icons/favicon_v2.png">
    <link rel="stylesheet" href="../css/theme.css">
    <style>
        .scorecard-hero {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dark) 100%);
            padding: 80px 20px 40px;
            text-align: center;
        }
        
        .scorecard-hero h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .scorecard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .match-header {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }
        
        .match-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .match-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 20px;
        }
        
        .match-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .teams-score-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            align-items: center;
            margin: 30px 0;
        }
        
        .team-score-box {
            text-align: center;
        }
        
        .team-logo-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            border: 3px solid var(--border-color);
            overflow: hidden;
        }
        
        .team-logo-large img {
            width: 60px;
            height: 60px;
            object-fit: contain;
        }
        
        .team-name-large {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .team-score-large {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-green);
        }
        
        .team-overs {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .vs-divider {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-muted);
            padding: 20px;
            background: var(--bg-primary);
            border-radius: 50%;
        }
        
        .match-result {
            text-align: center;
            padding: 15px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 8px;
            color: var(--accent-green);
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .scorecard-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .scorecard-tab {
            padding: 12px 24px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .scorecard-tab:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }
        
        .scorecard-tab.active {
            background: var(--accent-green);
            color: var(--bg-primary);
            border-color: var(--accent-green);
        }
        
        .innings-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            display: none;
        }
        
        .innings-section.active {
            display: block;
        }
        
        .innings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .innings-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .innings-score {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-green);
        }
        
        .scorecard-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .scorecard-table th {
            text-align: left;
            padding: 12px 15px;
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
        }
        
        .scorecard-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        
        .scorecard-table tr:hover td {
            background: rgba(0, 255, 136, 0.05);
        }
        
        .player-name {
            font-weight: 600;
        }
        
        .player-dismissal {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 3px;
        }
        
        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin: 25px 0 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .extras-row {
            background: var(--bg-primary);
        }
        
        .total-row {
            background: rgba(0, 255, 136, 0.1);
            font-weight: 700;
        }
        
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 100px 20px;
            gap: 20px;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-container {
            text-align: center;
            padding: 60px 20px;
        }
        
        .error-container h2 {
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .error-container p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        
        .btn-back {
            display: inline-block;
            padding: 12px 30px;
            background: var(--accent-green);
            color: var(--bg-primary);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-back:hover {
            background: var(--accent-green-dark);
            transform: scale(1.02);
        }
        
        @media (max-width: 768px) {
            .teams-score-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .vs-divider {
                display: none;
            }
            
            .scorecard-table {
                font-size: 0.85rem;
            }
            
            .scorecard-table th,
            .scorecard-table td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="nav-logo">
                <img src="../assets/images/logo_v2.png" alt="Surabhi Logo">
                <span>Surabhi</span>
            </a>
            <div class="nav-menu" id="navMenu">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="matches.html" class="nav-link">Matches</a>
                <a href="how-to-play.html" class="nav-link">How to Play</a>
                <a href="about.html" class="nav-link">About</a>
                <a href="contact.html" class="nav-link">Contact</a>
            </div>
            <div class="nav-actions">
                <a href="login.html" class="btn-login" id="loginBtn">Login</a>
                <a href="register.html" class="btn-register" id="registerBtn">Register</a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="scorecard-hero">
        <div class="container">
            <h1>üìä Match Scorecard</h1>
            <p>Detailed batting and bowling statistics</p>
        </div>
    </section>

    <!-- Scorecard Container -->
    <div class="scorecard-container" id="scorecardContainer">
        <div class="loading-container" id="loadingState">
            <div class="loading-spinner"></div>
            <p>Loading scorecard...</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <img src="../assets/images/logo_v2.png" alt="Surabhi Logo" class="footer-logo">
                    <p>India's most trusted FREE-TO-PLAY fantasy cricket platform for entertainment and education.</p>
                    <div class="footer-badges">
                        <span class="badge">18+</span>
                        <span class="badge">100% FREE</span>
                        <span class="badge">NO REAL MONEY</span>
                    </div>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <a href="../index.html">Home</a>
                    <a href="about.html">About Us</a>
                    <a href="how-to-play.html">How to Play</a>
                    <a href="faq.html">FAQ</a>
                    <a href="blog.html">Blog</a>
                    <a href="contact.html">Contact Us</a>
                </div>
                <div class="footer-links">
                    <h4>Legal</h4>
                    <a href="terms.html">Terms & Conditions</a>
                    <a href="privacy.html">Privacy Policy</a>
                    <a href="fair-play.html">Fair Play Policy</a>
                    <a href="responsible-gaming.html">Responsible Gaming</a>
                </div>
                <div class="footer-contact">
                    <h4>Contact Us</h4>
                    <p>üìç Ram Acchayvar 48/2, Ayodhya Puri 2<br>Bijnour, Sarojini Nagar<br>Lucknow, UP 226008</p>
                    <p>üìß support@skillarenasports.com</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2026 SDSURABHI INFRA PRIVATE LIMITED. All rights reserved.</p>
                <p class="disclaimer">FREE-TO-PLAY fantasy cricket platform operated by SDSURABHI INFRA PRIVATE LIMITED (CIN: U41002UP2023PTC194590). No real money involved. Users must be 18+. Users from Andhra Pradesh, Assam, Nagaland, Odisha, Sikkim, and Telangana are not permitted to participate.</p>
            </div>
        </div>
    </footer>

    <script src="../js/theme.js"></script>
    <script>
        // Get match ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const matchId = urlParams.get('match');
        
        if (!matchId) {
            showError('No match selected', 'Please select a match from the matches page.');
        } else {
            fetchScorecard(matchId);
        }
        
        async function fetchScorecard(matchId) {
            try {
                const response = await fetch(`/api/cricket/scorecard/${matchId}`);
                const data = await response.json();
                
                if (data.success && data.data) {
                    displayScorecard(data.data);
                } else {
                    showError('Scorecard not available', 'The scorecard for this match is not available yet.');
                }
            } catch (error) {
                console.error('Error fetching scorecard:', error);
                showError('Failed to load scorecard', 'Please try again later.');
            }
        }
        
        function displayScorecard(match) {
            const container = document.getElementById('scorecardContainer');
            
            const team1 = match.teamInfo?.[0] || { name: match.teams?.[0] || 'Team 1' };
            const team2 = match.teamInfo?.[1] || { name: match.teams?.[1] || 'Team 2' };
            
            // Get scores
            const score1 = match.score?.[0];
            const score2 = match.score?.[1];
            
            const score1Display = score1 ? `${score1.r}/${score1.w}` : '-';
            const score2Display = score2 ? `${score2.r}/${score2.w}` : '-';
            const overs1 = score1 ? `(${score1.o} ov)` : '';
            const overs2 = score2 ? `(${score2.o} ov)` : '';
            
            let html = `
                <!-- Match Header -->
                <div class="match-header">
                    <h2 class="match-title">${match.name || 'Cricket Match'}</h2>
                    <div class="match-meta">
                        <span>üìÖ ${match.date || 'Date TBA'}</span>
                        <span>üìç ${match.venue || 'Venue TBA'}</span>
                        <span>üèè ${match.matchType?.toUpperCase() || 'MATCH'}</span>
                    </div>
                    
                    <div class="teams-score-container">
                        <div class="team-score-box">
                            <div class="team-logo-large">
                                <img src="${team1.img || '../assets/images/cricket-ball.png'}" alt="${team1.name}" onerror="this.src='../assets/images/cricket-ball.png'">
                            </div>
                            <div class="team-name-large">${team1.shortname || team1.name}</div>
                            <div class="team-score-large">${score1Display}</div>
                            <div class="team-overs">${overs1}</div>
                        </div>
                        
                        <div class="vs-divider">VS</div>
                        
                        <div class="team-score-box">
                            <div class="team-logo-large">
                                <img src="${team2.img || '../assets/images/cricket-ball.png'}" alt="${team2.name}" onerror="this.src='../assets/images/cricket-ball.png'">
                            </div>
                            <div class="team-name-large">${team2.shortname || team2.name}</div>
                            <div class="team-score-large">${score2Display}</div>
                            <div class="team-overs">${overs2}</div>
                        </div>
                    </div>
                    
                    ${match.status ? `<div class="match-result">${match.status}</div>` : ''}
                </div>
            `;
            
            // Check if we have detailed scorecard
            if (match.scorecard && match.scorecard.length > 0) {
                // Innings tabs
                html += `<div class="scorecard-tabs">`;
                match.scorecard.forEach((innings, index) => {
                    html += `<button class="scorecard-tab ${index === 0 ? 'active' : ''}" data-innings="${index}">${innings.inning || `Innings ${index + 1}`}</button>`;
                });
                html += `</div>`;
                
                // Innings sections
                match.scorecard.forEach((innings, index) => {
                    html += `
                        <div class="innings-section ${index === 0 ? 'active' : ''}" id="innings${index}">
                            <div class="innings-header">
                                <div class="innings-title">${innings.inning || `Innings ${index + 1}`}</div>
                                <div class="innings-score">${innings.r || 0}/${innings.w || 0} (${innings.o || 0} ov)</div>
                            </div>
                            
                            <!-- Batting -->
                            <h3 class="section-title">üèè Batting</h3>
                            <table class="scorecard-table">
                                <thead>
                                    <tr>
                                        <th>Batter</th>
                                        <th>R</th>
                                        <th>B</th>
                                        <th>4s</th>
                                        <th>6s</th>
                                        <th>SR</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${innings.batting ? innings.batting.map(batter => `
                                        <tr>
                                            <td>
                                                <div class="player-name">${batter.batsman?.name || batter.batsman || 'Unknown'}</div>
                                                <div class="player-dismissal">${batter.dismissal || batter['dismissal-text'] || ''}</div>
                                            </td>
                                            <td><strong>${batter.r || 0}</strong></td>
                                            <td>${batter.b || 0}</td>
                                            <td>${batter['4s'] || 0}</td>
                                            <td>${batter['6s'] || 0}</td>
                                            <td>${batter.sr || (batter.b ? ((batter.r / batter.b) * 100).toFixed(1) : '0.0')}</td>
                                        </tr>
                                    `).join('') : '<tr><td colspan="6">No batting data available</td></tr>'}
                                    <tr class="extras-row">
                                        <td>Extras</td>
                                        <td colspan="5">${innings.extras || 0} (b ${innings.byes || 0}, lb ${innings.legbyes || 0}, w ${innings.wides || 0}, nb ${innings.noballs || 0})</td>
                                    </tr>
                                    <tr class="total-row">
                                        <td>Total</td>
                                        <td colspan="5">${innings.r || 0}/${innings.w || 0} (${innings.o || 0} overs)</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- Bowling -->
                            <h3 class="section-title">üéØ Bowling</h3>
                            <table class="scorecard-table">
                                <thead>
                                    <tr>
                                        <th>Bowler</th>
                                        <th>O</th>
                                        <th>M</th>
                                        <th>R</th>
                                        <th>W</th>
                                        <th>Econ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${innings.bowling ? innings.bowling.map(bowler => `
                                        <tr>
                                            <td class="player-name">${bowler.bowler?.name || bowler.bowler || 'Unknown'}</td>
                                            <td>${bowler.o || 0}</td>
                                            <td>${bowler.m || 0}</td>
                                            <td>${bowler.r || 0}</td>
                                            <td><strong>${bowler.w || 0}</strong></td>
                                            <td>${bowler.eco || (bowler.o ? (bowler.r / bowler.o).toFixed(1) : '0.0')}</td>
                                        </tr>
                                    `).join('') : '<tr><td colspan="6">No bowling data available</td></tr>'}
                                </tbody>
                            </table>
                        </div>
                    `;
                });
            } else {
                html += `
                    <div class="innings-section active">
                        <p style="text-align: center; color: var(--text-secondary); padding: 40px;">
                            Detailed scorecard is not available for this match yet.<br>
                            Please check back later or view the match summary above.
                        </p>
                    </div>
                `;
            }
            
            html += `
                <div style="text-align: center; margin-top: 30px;">
                    <a href="matches.html" class="btn-back">‚Üê Back to Matches</a>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Add tab functionality
            document.querySelectorAll('.scorecard-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const inningsIndex = tab.dataset.innings;
                    
                    document.querySelectorAll('.scorecard-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.innings-section').forEach(s => s.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(`innings${inningsIndex}`).classList.add('active');
                });
            });
        }
        
        function showError(title, message) {
            const container = document.getElementById('scorecardContainer');
            container.innerHTML = `
                <div class="error-container">
                    <h2>${title}</h2>
                    <p>${message}</p>
                    <a href="matches.html" class="btn-back">‚Üê Back to Matches</a>
                </div>
            `;
        }
    </script>
</body>
</html>
